// Firestore Security Rules for CRBFTN Website
// Copy these rules to your Firebase Console > Firestore Database > Rules

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Allow read/write access to quotes collection for authenticated users
    // Allow write access for anonymous users (for quote submissions)
    match /quotes/{document} {
      // Allow anyone to create new quotes (for website submissions)
      allow create: if true;
      
      // Allow read/write for authenticated admin users only
      allow read, update, delete: if request.auth != null && 
        request.auth.token.admin == true;
    }
    
    // Allow read/write access to mailing-list collection
    match /mailing-list/{document} {
      // Allow anyone to add emails to mailing list
      allow create: if true;
      
      // Allow read/write for authenticated admin users only
      allow read, update, delete: if request.auth != null && 
        request.auth.token.admin == true;
    }
    
    // Deny all other access
    match /{document=**} {
      allow read, write: if false;
    }
  }
}

/*
SETUP INSTRUCTIONS:

1. Go to Firebase Console: https://console.firebase.google.com/
2. Select your project
3. Go to Firestore Database
4. Click on "Rules" tab
5. Replace the default rules with the rules above
6. Click "Publish"

SECURITY EXPLANATION:

- quotes collection: Anyone can create (submit quotes), only admins can read/modify
- mailing-list collection: Anyone can add emails, only admins can read/modify
- All other collections: Completely restricted

For admin access, you'll need to set custom claims in Firebase Auth.
*/